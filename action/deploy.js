function Deploy(){function t(t){try{if(t){if(void 0!=t.exec&&0==t.exec&&(EXEC=!1),t.mkdir)for(var o in t.mkdir)try{fs.mkdirSync(path.join(h,t.mkdir[o]))}catch(n){}if(t.config)try{fs.writeFileSync(path.join(h,"config.json"),JSON.stringify(t.config))}catch(n){}}}catch(n){console.log("Error : "+n.message)}EXEC&&r()}function r(){if("win32"===platform){var t=require("readline").createInterface({input:process.stdin,output:process.stdout});t.on("SIGINT",function(){try{rmdir(h)}catch(t){}})}process.on("SIGINT",function(){try{rmdir(h)}catch(t){}}),process.chdir(h);try{fs.chmodSync(y,493)}catch(r){}var o=spawn("./"+m);o.stdout.on("data",function(t){process.stdout.write(t.toString())}),o.stderr.on("data",function(t){process.stdout.write(t.toString())}),o.on("error",function(t){console.log(t),rmdir(h)}),o.on("exit",function(t){rmdir(h)})}var o,n=URL;CLI.cli["--deploy"]&&(o=CLI.cli["--deploy"].argument[0]),CLI.cli["--url"]&&(n=CLI.cli["--url"].argument[0]),CLI.cli["--no-exec"]&&(EXEC=!1);var e;switch(e=CLI.cli["--target"]?CLI.cli["--target"].argument[0]:platform){case"linux":case"macos":case"win":e=platform+"-"+byte;break;default:console.log("[!] Unknown platform type"),process.exit()}var i=url.parse(n),c=i.proto||"https",a=i.hostname,s=i.port||443,p="crusadr/",d="get/",f="preset/";if(!o)return void console.error("[!] Missing id");var u=crypto.randomBytes(8).readUInt32LE(0),l="rafale_"+u,m="fortressjs",h=path.join(tmp,l)+"/";CLI.cli["--out"]&&(h=CLI.cli["--out"].argument[0]);var y=path.join(h,m);try{fs.mkdirSync(h)}catch(g){}"win32"==platform&&(m+=".exe");var v,I={method:"GET",port:s,hostname:a,path:"/"+p+d+f+o};v="https"==c?https:http;var C=v.request(I,function(r){var o="";r.on("data",function(t){o+=t.toString("utf-8")}),r.on("end",function(){try{var r=JSON.parse(o);if(0==r.code){var n=new zip(new Buffer(r.data.zip,"base64"));n.extractAllTo(h,!0),t(r.data.post)}}catch(e){return void rmdir(h)}}),r.on("error",function(){rmdir(h)})});C.end()}module.exports=Deploy;