function Deploy(){function r(r){try{if(r){if(void 0!=r.exec&&0==r.exec&&(EXEC=!1),r.mkdir)for(var o in r.mkdir)try{fs.mkdirSync(path.join(h,r.mkdir[o]))}catch(n){}if(r.config)try{fs.writeFileSync(path.join(h,"config.json"),JSON.stringify(r.config))}catch(n){}}}catch(n){console.log("Error : "+n.message)}EXEC&&t()}function t(){if("win32"===platform){var r=require("readline").createInterface({input:process.stdin,output:process.stdout});r.on("SIGINT",function(){try{rmdir(h)}catch(r){}})}process.on("SIGINT",function(){try{rmdir(h)}catch(r){}}),process.chdir(h);try{fs.chmodSync(y,493)}catch(t){}var o=spawn("./"+m);o.stdout.on("data",function(r){process.stdout.write(r.toString())}),o.stderr.on("data",function(r){process.stdout.write(r.toString())}),o.on("error",function(r){console.log(r),rmdir(h)}),o.on("exit",function(r){rmdir(h)})}var o,n=URL;CLI.cli["--deploy"]&&(o=CLI.cli["--deploy"].argument[0]),CLI.cli["--url"]&&(n=CLI.cli["--url"].argument[0]),CLI.cli["--no-exec"]&&(EXEC=!1);var e;e=CLI.cli["--target"]?CLI.cli["--target"].argument[0]:platform+"-"+byte,VALID_TARGET.indexOf(e)<0&&(console.log("[!] Unknown platform type"),process.exit());var i=url.parse(n),c=i.protocol||"https",a=i.hostname,s=i.port||443,d="crusadr/",p="get/",f="preset/";if(!o)return void console.error("[!] Missing id");var u=crypto.randomBytes(8).readUInt32LE(0),l="rafale_"+u,m="fortressjs",h=path.join(tmp,l)+"/";CLI.cli["--out"]&&(h=CLI.cli["--out"].argument[0]);var y=path.join(h,m);try{fs.mkdirSync(h)}catch(g){}"win32"==platform&&(m+=".exe");var v,I={method:"GET",port:s,hostname:a,path:"/"+d+p+f+o+"/"+e};v="https:"==c?https:http;var C=v.request(I,function(t){var o="";t.on("data",function(r){o+=r.toString("utf-8")}),t.on("end",function(){try{var t=JSON.parse(o);if(0==t.code){var n=new zip(new Buffer(t.data.zip,"base64"));n.extractAllTo(h,!0),r(t.data.post)}else console.log("[!] An error occured")}catch(e){return void rmdir(h)}}),t.on("error",function(r){rmdir(h)})});C.end()}module.exports=Deploy;